
<!DOCTYPE HTML> 
<html> 
<head> 
<title>PhoneGap</title> 
	<script type="text/javascript" charset="utf-8" src="js/phonegap.0.9.4.js"></script>  
	<link rel="stylesheet" href="css/jquery.mobile-1.0a4.1.css" /> 
	<script src="js/jquery-1.5.2.min.js"></script> 
	<script src="js/jquery.mobile-1.0a4.1.js"></script> 
	
	<script type="text/javascript"> 
 	var lat,log;
	$().ready( function() {
		
		$('#searchButton').click(function() {
		
		    function reachableCallback(reachability) {
    			// There is no consistency on the format of reachability
    			var networkState = reachability.code || reachability;
 
    			var states = {};
    			states[NetworkStatus.NOT_REACHABLE]                      = 'No network connection';
    			states[NetworkStatus.REACHABLE_VIA_CARRIER_DATA_NETWORK] = 'Carrier data connection';
    			states[NetworkStatus.REACHABLE_VIA_WIFI_NETWORK]         = 'WiFi connection';
 
    			alert('Connection type: ' + states[networkState]);
			}
 
			navigator.network.isReachable('phonegap.com', reachableCallback);
  			
  			
  			$.getJSON('http://dulichvn.freevnn.com/services/geo/key/'+$('#searchKey').val()+'/lat/' + lat + '/log' + log + '/type/'+$('#searchBox').val(), 
  			function(data) {
  			    
  			    var items=data.Items;
  			    var list = $('#list');
  			    list.html("");
  				$.each(items, function(key, val) {
  				    
    				list.append(
      				  $(document.createElement('li')).html(val.Name)
    				);
  				});
  				
  				
  				list.listview("destroy").listview()
 
			});
  			
		});
 
  	    //document.addEventListener("deviceready", onDeviceReady, false);
 
	} );
	
 	// Wait for PhoneGap to load
    //
    function onLoad() {
        document.addEventListener("deviceready", onDeviceReady, false);
    }
    // PhoneGap is loaded and it is now safe to make calls PhoneGap methods
    //
    function onDeviceReady() {
        navigator.geolocation.getCurrentPosition(onSuccess, onError,{ enableHighAccuracy: true });
    }
    
    // onSuccess Geolocation
    //
    function onSuccess(position) {
        var element = document.getElementById('geolocation');
        lat = position.coords.latitude  ;
        log = position.coords.longitude ;
        element.innerHTML = 'Latitude: '           + position.coords.latitude              + '<br />' +
                            'Longitude: '          + position.coords.longitude             + '<br />' +
                            'Altitude: '           + position.coords.altitude              + '<br />' +
                            'Accuracy: '           + position.coords.accuracy              + '<br />' +
                            'Altitude Accuracy: '  + position.coords.altitudeAccuracy      + '<br />' +
                            'Heading: '            + position.coords.heading               + '<br />' +
                            'Speed: '              + position.coords.speed                 + '<br />' +
                            'Timestamp: '          + new Date(position.timestamp)          + '<br />';
    }

    // onError Callback receives a PositionError object
    //
    function onError(error) {
        alert('code: '    + error.code    + '\n' +
              'message: ' + error.message + '\n');
    }
 
</script>  
  
</head> 
<body onload="onLoad()"> 
 
    <div data-role="page" id="home"> 
 
  <div data-role="header"> 
    <h1>Tour De VN</h1> 
  </div> 
 
  <div data-role="content"> 
    <p>Find Your Place To Travel Or Get Your Location </p> 
    <p><a href="#search" data-role="button">Search GoldPlace</a></p>    
    <p><a href="#location" data-role="button">Your Location</a></p> 
  </div> 
 
</div> 
 
<div data-role="page" id="search"> 
 
  <div data-role="header" data-position="fixed"> 
    <h1>Search GoldPlace</h1> 
    <p>Find goldplace near your location</p>
    <div class="ui-body ui-body-b"> 
         <label for="searchKey">Your Api Key</label>
         <br/>
         <input type="text" name="search" id="searchKey" value="9cac87" data-theme="a" /> 
         <br/>
         <label for="searchBox">Keyword </label>
         <br/>
         <select name="search" id="searchBox" data-theme="a" style="height: 32px; width: 155px; ">
         	<option value="all">all</option>
         	<option value="coffee">coffee</option>
         	<option value="shop">shop</option>
         	<option value="restaurant">restaurant</option>
         	<option value="company">company</option>
         </select>
         <button type="submit" data-theme="a" id="searchButton">Search</button>     
      
    </div>  
  </div> 
 
  <div data-role="content"> 
     
     <ul data-role="listview" id="list"> 
      
    </ul> 
      
        
    
  </div> 
 
</div> 
 
<div data-role="page" id="location"> 
 
  <div data-role="header"> 
    <h1> Current location</h1> 
  </div> 
 
  <div data-role="content"> 
    <p id="geolocation">Your locaton : !</p> 
     
  </div> 
 
</div> 
 
</body> 
</html>